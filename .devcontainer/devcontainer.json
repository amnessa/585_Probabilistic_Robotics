{
    "name": "ROS Humble Dev Container",
    "image": "osrf/ros:humble-desktop-full", // <-- Make sure this is correct

    // Add these runArgs for GUI forwarding
    "runArgs": [
        "--network=host",
        "--privileged",
        "--volume=/tmp/.X11-unix:/tmp/.X11-unix", // Mount X11 socket
        "--gpus=all",                              // Enable GPU support
        "--volume=/usr/share/glvnd/egl_vendor.d:/usr/share/glvnd/egl_vendor.d:ro"
       // Optional: Mount your ROS workspace if needed later
       // "--volume=${localWorkspaceFolder}:/workspaces/${localWorkspaceFolderBasename}",
       // "--workdir=/workspaces/${localWorkspaceFolderBasename}"
    ],

    // Set the DISPLAY environment variable
    "containerEnv": {
        "DISPLAY": "${localEnv:DISPLAY}",
        "__GLX_VENDOR_LIBRARY_NAME": "nvidia",
        "NVIDIA_VISIBLE_DEVICES": "all",
        "NVIDIA_DRIVER_CAPABILITIES": "graphics,utility,compute,display"
    },

    // Keep the container running even if VS Code closes
    "shutdownAction": "stopContainer",

    // Add ROS specific VS Code extensions if you like
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-iot.vscode-ros",
                "ms-python.python",
                "alefragnani.bookmarks",
                "donjayamanne.githistory",
                "donjayamanne.python-environment-manager",
                "eamodio.gitlens",
                "github.copilot",
                "github.copilot-chat",
                "github.vscode-pull-request-github",
                "gruntfuggly.todo-tree",
                "guyutongxue.cpp-reference",
                "mathworks.language-matlab",
                "ms-azuretools.vscode-containers",
                "ms-azuretools.vscode-docker",
                "ms-python.debugpy",
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-python.vscode-python-envs",
                "ms-toolsai.datawrangler",
                "ms-toolsai.jupyter",
                "ms-toolsai.jupyter-keymap",
                "ms-toolsai.jupyter-renderers",
                "ms-toolsai.vscode-jupyter-cell-tags",
                "ms-toolsai.vscode-jupyter-slideshow",
                "ms-vscode.cmake-tools",
                "ms-vscode.cpptools",
                "ms-vscode.cpptools-extension-pack",
                "ms-vscode.cpptools-themes",
                "ms-vscode.powershell",
                "ms-vscode.remote-explorer",
                "ms-vscode-remote.remote-containers",
                "ms-vscode.remote-server",
                "platformio.platformio-ide",
                "ranch-hand-robotics.rde-pack",
                "ranch-hand-robotics.rde-ros-2",
                "ranch-hand-robotics.urdf-editor",
                "shd101wyy.markdown-preview-enhanced",
                "tomoki1207.pdf",
                "twxs.cmake",
                "yzane.markdown-pdf"
            ]
        }
    },

    // Install slam_toolbox and ensure terminal sources ROS setup
    "postCreateCommand": "apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y ros-humble-slam-toolbox && echo 'source /opt/ros/humble/setup.bash' >> ~/.bashrc"
}